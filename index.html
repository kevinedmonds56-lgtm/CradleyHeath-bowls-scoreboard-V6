<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bowls Club Scoreboard V6</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    :root {
    --bg-color: #0b3d0b;
    --panel-bg: #145214;
    --panel-border: #ffffff;
    --text-color: #ffffff;
    --score-bg: #ffffff;
    --score-text: #000000;
    --accent-color: #ffd700;

    --home-win: #00c853;
    --away-win: #ff5252;
    --draw-colour: #ffd740;
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: Arial, sans-serif;
    background: radial-gradient(circle at top, #145214, #021902);
    color: var(--text-color);
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* HEADER */
header {
    padding: 6px 10px;
    background: #022502;
    border-bottom: 2px solid var(--panel-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

header h1 {
    font-size: 1.1rem;
    letter-spacing: 1px;
}

.controls {
    display: flex;
    gap: 6px;
    align-items: center;
    font-size: 0.85rem;
}

.controls select {
    padding: 3px 5px;
    border-radius: 4px;
    border: 1px solid var(--panel-border);
    background: #0b3d0b;
    color: var(--text-color);
}

/* MATCH SETUP PANEL */
#setupPanel {
    background: #0b3d0b;
    border-bottom: 2px solid var(--panel-border);
    padding: 8px;
    display: flex;
    flex-direction: column;
    gap: 6px;
}

#setupPanel h2 {
    font-size: 0.95rem;
    color: var(--accent-color);
    text-align: center;
}

.setup-row {
    display: flex;
    gap: 8px;
    align-items: center;
}

.setup-row label {
    width: 90px;
    font-size: 0.85rem;
}

.setup-row input {
    flex: 1;
    padding: 4px;
    border-radius: 4px;
    border: 1px solid var(--panel-border);
    background: #e8ffe8;
    color: #000;
}

#hideSetupBtn,
#showSetupBtn,
#resetScoresBtn {
    padding: 5px 8px;
    border-radius: 4px;
    border: 1px solid var(--panel-border);
    background: #145214;
    color: var(--text-color);
    cursor: pointer;
    font-size: 0.85rem;
}

#showSetupBtn {
    position: fixed;
    top: 8px;
    right: 8px;
    display: none;
}

/* MAIN LAYOUT */
main {
    flex: 1;
    overflow-y: auto;   /* FIXED: allows scrolling when setup panel is open */
    padding: 6px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

#gamesContainer {
    display: grid;
    grid-template-columns: 1fr;
    gap: 6px;
    flex: 1;
}

/* GAME BLOCKS */
.game-block {
    background: var(--panel-bg);
    border: 2px solid var(--panel-border);
    border-radius: 6px;
    padding: 6px;
    display: flex;
    flex-direction: column;
    gap: 4px;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.game-title {
    font-weight: bold;
    font-size: 0.9rem;
    color: var(--accent-color);
    text-align: center;
    margin-bottom: 2px;
}

.label {
    font-size: 0.75rem;
}

.text-input {
    width: 100%;
    padding: 3px;
    border-radius: 4px;
    border: 1px solid var(--panel-border);
    background: #e8ffe8;
    color: #000;
    font-size: 0.8rem;
}

/* SCORE INPUTS */
.score-input {
    width: 50px;
    padding: 3px;
    font-size: 1rem;
    font-weight: bold;
    text-align: center;
    border-radius: 4px;
    border: 1px solid var(--panel-border);
    background: var(--score-bg);
    color: var(--score-text);
}

.team-row {
    display: grid;
    grid-template-columns: 1.2fr 0.8fr;
    align-items: center;
    gap: 4px;
}

.team-name {
    font-weight: bold;
    font-size: 0.85rem;
}

/* SECTION INDICATOR */
.section-indicator {
    text-align: center;
    font-size: 0.75rem;
    color: #dddddd;
}

/* TOTALS BAR */
#totalsBar {
    border-top: 1px solid var(--panel-border);
    padding-top: 4px;
    font-size: 0.9rem;
    text-align: center;
}

/* INFO BUTTON */
#infoButton {
    position: fixed;
    right: 10px;
    bottom: 10px;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 2px solid var(--panel-border);
    background: #0b3d0b;
    color: var(--text-color);
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

#infoPanel {
    position: fixed;
    right: 10px;
    bottom: 50px;
    background: rgba(0,0,0,0.85);
    color: #ffffff;
    padding: 8px 10px;
    border-radius: 6px;
    font-size: 0.8rem;
    max-width: 260px;
    display: none;
    border: 1px solid #ffffff;
}

/* MULTI-COLUMN LAYOUT FOR 1920×1080 */
@media (min-width: 900px) {
    #gamesContainer {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (min-width: 1400px) {
    #gamesContainer {
        grid-template-columns: repeat(3, 1fr);
    }
}
</style>
</head>
<body>

<header>
    <h1>Cradley Heath Bowls Scoreboard V6</h1>
    <div class="controls">
        <label for="matchType">Match Type:</label>
        <select id="matchType">
            <option value="6">6 Games</option>
            <option value="8">8 Games</option>
            <option value="12">12 Games</option>
        </select>
    </div>
</header>

<!-- MATCH SETUP PANEL (Visible by default) -->
<div id="setupPanel">
    <h2>MATCH SETUP</h2>

    <div class="setup-row">
        <label>Home Team:</label>
        <input id="homeTeamInput" placeholder="Cradley Heath A">
    </div>

    <div class="setup-row">
        <label>Away Team:</label>
        <input id="awayTeamInput" placeholder="Away Team">
    </div>

    <div class="setup-row">
        <button id="hideSetupBtn">Hide Setup</button>
        <button id="resetScoresBtn">Reset All Scores</button>
    </div>
</div>

<button id="showSetupBtn">Show Setup</button>

<main>
    <div id="gamesContainer"></div>
    <div id="totalsBar">TOTALS — Home: 0 &nbsp;&nbsp; Away: 0</div>
    <div class="section-indicator" id="sectionIndicator"></div>
</main>

<button id="infoButton">i</button>
<div id="infoPanel">
    <strong>Scoreboard V6</strong><br>
    - Set team names in MATCH SETUP.<br>
    - Players vary per game.<br>
    - Portrait: all games.<br>
    - Landscape: rotates when needed.<br>
</div>
<script>
// ===============================
// GLOBALS
// ===============================
let allGames = [];

const matchTypeSelect = document.getElementById("matchType");
const gamesContainer = document.getElementById("gamesContainer");
const totalsBar = document.getElementById("totalsBar");
const sectionIndicator = document.getElementById("sectionIndicator");

const homeTeamInput = document.getElementById("homeTeamInput");
const awayTeamInput = document.getElementById("awayTeamInput");

const hideSetupBtn = document.getElementById("hideSetupBtn");
const showSetupBtn = document.getElementById("showSetupBtn");
const resetScoresBtn = document.getElementById("resetScoresBtn");

const setupPanel = document.getElementById("setupPanel");

const infoButton = document.getElementById("infoButton");
const infoPanel = document.getElementById("infoPanel");


// ===============================
// CREATE GAME DATA
// ===============================
function createGameData(total) {
    allGames = [];
    for (let i = 1; i <= total; i++) {
        allGames.push({
            rink: i,
            homePlayers: "",
            awayPlayers: "",
            homeScore: "",
            awayScore: ""
        });
    }
}


// ===============================
// RENDER ALL GAMES
// ===============================
function renderGames() {
    gamesContainer.innerHTML = "";

    allGames.forEach((g, index) => {
        const block = document.createElement("div");
        block.className = "game-block";

        block.innerHTML = `
            <div class="game-title">Game ${g.rink}</div>

            <div class="team-row">
                <input class="text-input" 
                       placeholder="Home players"
                       value="${g.homePlayers}"
                       data-index="${index}"
                       data-field="homePlayers">
                <input class="score-input"
                       value="${g.homeScore}"
                       data-index="${index}"
                       data-field="homeScore">
            </div>

            <div class="team-row">
                <input class="text-input" 
                       placeholder="Away players"
                       value="${g.awayPlayers}"
                       data-index="${index}"
                       data-field="awayPlayers">
                <input class="score-input"
                       value="${g.awayScore}"
                       data-index="${index}"
                       data-field="awayScore">
            </div>
        `;

        gamesContainer.appendChild(block);
    });

    attachInputListeners();
}


// ===============================
// ATTACH INPUT LISTENERS
// ===============================
function attachInputListeners() {
    const inputs = gamesContainer.querySelectorAll("input");

    inputs.forEach(input => {
        input.addEventListener("input", (e) => {
    const idx = parseInt(e.target.dataset.index, 10);
    const field = e.target.dataset.field;
    allGames[idx][field] = e.target.value;

    // Only scores should trigger a full update
    if (field === "homeScore" || field === "awayScore") {
        updateTotals();
    }
});
    });
}


// ===============================
// UPDATE TOTALS
// ===============================
function updateTotals() {
    let homeTotal = 0;
    let awayTotal = 0;

    allGames.forEach(g => {
        const h = parseInt(g.homeScore, 10);
        const a = parseInt(g.awayScore, 10);

        if (!isNaN(h)) homeTotal += h;
        if (!isNaN(a)) awayTotal += a;
    });

    totalsBar.innerHTML = `TOTALS — ${homeTeamInput.value || "Home"}: ${homeTotal} &nbsp;&nbsp; ${awayTeamInput.value || "Away"}: ${awayTotal}`;
}


// ===============================
// UPDATE LAYOUT (ROTATION + RENDER)
// ===============================
function updateLayout() {
    renderGames();
    updateTotals();

    const width = window.innerWidth;
    const height = window.innerHeight;

    if (width > height) {
        sectionIndicator.textContent = "Landscape Mode — Auto Rotation Active";
    } else {
        sectionIndicator.textContent = "Portrait Mode — All Games Visible";
    }
}


// ===============================
// EVENT LISTENERS
// ===============================
matchTypeSelect.addEventListener("change", () => {
    const total = parseInt(matchTypeSelect.value, 10);
    createGameData(total);
    updateLayout();
});

window.addEventListener("resize", updateLayout);

hideSetupBtn.addEventListener("click", () => {
    setupPanel.style.display = "none";
    showSetupBtn.style.display = "block";
    updateLayout();
});

showSetupBtn.addEventListener("click", () => {
    setupPanel.style.display = "flex";
    showSetupBtn.style.display = "none";
    updateLayout();
});

resetScoresBtn.addEventListener("click", () => {
    allGames.forEach(g => {
        g.homeScore = "";
        g.awayScore = "";
    });
    updateLayout();
});

homeTeamInput.addEventListener("input", updateTotals);
awayTeamInput.addEventListener("input", updateTotals);

infoButton.addEventListener("click", () => {
    infoPanel.style.display = infoPanel.style.display === "block" ? "none" : "block";
});

document.addEventListener("click", (e) => {
    if (!infoPanel.contains(e.target) && e.target !== infoButton) {
        infoPanel.style.display = "none";
    }
});


// ===============================
// INITIALISE
// ===============================
function init() {
    const total = parseInt(matchTypeSelect.value, 10);
    createGameData(total);
    updateLayout();
}

init();
</script>
</body>
</html>
